 #-*-coding:utf-8 -*-
import csv

def process(d, i):
	if i not in d.keys():
		return 0
	count = 0
	for t in d[i]:
		count += 1 + process(d, t)
	return count

file1 = open("graph_torch.csv")
reader = csv.reader(file1)
next(reader)
d = dict()
s = set()
for row in reader:
	try:
		s.add(row[0])
		s.add(row[1])
		if row[1] not in d.keys():
			d[row[1]] = [row[0]]
		else:
			d[row[1]].append(row[0])
	except:
		continue
d2 = dict()
for k in s:
	d2[k] = 1
for k in d.keys():
	in_degree = 0
	for i in d[k]:	
		in_degree += 1+process(d, i)
	d2[k] = in_degree

d2 = sorted(d2.items(), key=lambda x: x[1], reverse=True)

file2 = open("indegree_torch.csv", 'w')
writer = csv.writer(file2)	
writer.writerow(['node', 'weight'])
for k in d2:
	writer.writerow([k[0], k[1]])
file1.close()
file2.close()

